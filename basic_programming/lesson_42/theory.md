### Lesson 42


В Java исключения (exceptions) — это способ обработки ошибок и других необычных ситуаций, возникающих во время выполнения программы. Исключения в Java делятся на два основных типа: проверяемые (checked) и непроверяемые (unchecked) исключения. Это разделение влияет на то, как разработчики должны обрабатывать эти исключения в своём коде.
В Java, исключения (`exceptions`) являются объектами, которые описывают исключительную ситуацию, возникающую в процессе выполнения программы. Исключения используются для обработки ошибок и других нештатных ситуаций в управляемом и структурированном виде.


### Проверяемые исключения (Checked Exceptions)
- **Что такое**: Проверяемые исключения — это исключения, которые должны быть явно обработаны в программе с помощью блока `try-catch` или объявлены в сигнатуре метода с помощью ключевого слова `throws`. Эти исключения представляют собой условия, от которых можно восстановиться, и они обычно возникают во время выполнения операций ввода-вывода (I/O operations), работы с файлами, сетевых соединений и т.д.
- **Примеры**: `IOException`, `SQLException` и пользовательские классы исключений, наследующиеся от класса `Exception`, но не от `RuntimeException`.
- **Цель**: Заставить разработчика явно обрабатывать потенциально опасные операции, которые могут вызвать исключения, тем самым уменьшая вероятность непредвиденного прерывания программы.

### Непроверяемые исключения (Unchecked Exceptions)
- **Что такое**: Непроверяемые исключения — это исключения, которые не требуют обязательной обработки в программе. Эти исключения обычно возникают из-за ошибок в логике программы, таких как неверные аргументы, обращение по нулевой ссылке и т.д. Разработчики могут, но не обязаны явно обрабатывать эти исключения.
- **Примеры**: `RuntimeException`, `NullPointerException`, `ArrayIndexOutOfBoundsException` и другие наследники класса `RuntimeException`.
- **Цель**: Указывать на ошибки в программе, которые могут быть предотвращены перед выполнением программы. Обработка таких исключений часто указывает на наличие ошибок в логике программы, которые должны быть исправлены.

### Особенности обработки
- **Проверяемые исключения** требуют явной обработки, что заставляет разработчика предвидеть и обработать потенциальные проблемы на этапе компиляции.
- **Непроверяемые исключения** предоставляют больше гибкости, позволяя разработчикам решать, стоит ли обрабатывать исключение явно или позволить программе завершиться из-за непредвиденной ошибки.

В Java исключения (exceptions) — это способ обработки ошибок и других необычных ситуаций, возникающих во время выполнения программы. Исключения в Java делятся на два основных типа: проверяемые (checked) и непроверяемые (unchecked) исключения. Это разделение влияет на то, как разработчики должны обрабатывать эти исключения в своём коде.

### Проверяемые исключения (Checked Exceptions)
- **Что такое**: Проверяемые исключения — это исключения, которые должны быть явно обработаны в программе с помощью блока `try-catch` или объявлены в сигнатуре метода с помощью ключевого слова `throws`. Эти исключения представляют собой условия, от которых можно восстановиться, и они обычно возникают во время выполнения операций ввода-вывода (I/O operations), работы с файлами, сетевых соединений и т.д.
- **Примеры**: `IOException`, `SQLException` и пользовательские классы исключений, наследующиеся от класса `Exception`, но не от `RuntimeException`.
- **Цель**: Заставить разработчика явно обрабатывать потенциально опасные операции, которые могут вызвать исключения, тем самым уменьшая вероятность непредвиденного прерывания программы.

### Непроверяемые исключения (Unchecked Exceptions)
- **Что такое**: Непроверяемые исключения — это исключения, которые не требуют обязательной обработки в программе. Эти исключения обычно возникают из-за ошибок в логике программы, таких как неверные аргументы, обращение по нулевой ссылке и т.д. Разработчики могут, но не обязаны явно обрабатывать эти исключения.
- **Примеры**: `RuntimeException`, `NullPointerException`, `ArrayIndexOutOfBoundsException` и другие наследники класса `RuntimeException`.
- **Цель**: Указывать на ошибки в программе, которые могут быть предотвращены перед выполнением программы. Обработка таких исключений часто указывает на наличие ошибок в логике программы, которые должны быть исправлены.

### Особенности обработки
- **Проверяемые исключения** требуют явной обработки, что заставляет разработчика предвидеть и обработать потенциальные проблемы на этапе компиляции.
- **Непроверяемые исключения** предоставляют больше гибкости, позволяя разработчикам решать, стоит ли обрабатывать исключение явно или позволить программе завершиться из-за непредвиденной ошибки.

Такое разделение исключений на проверяемые и непроверяемые позволяет разработчикам Java более тонко управлять обработкой ошибок, делая программы более надёжными и устойчивыми к ошибкам.

### Типы исключений

В Java исключения делятся на две основные категории:

1. **Проверяемые исключения (`checked exceptions`)**: Это исключения, которые должны быть явно перехвачены или объявлены в методе. Они представляют собой условия, от которых можно восстановиться. Например, `IOException` возникает при ошибках ввода/вывода, и программа может попытаться решить проблему или корректно её обработать.

2. **Непроверяемые исключения (`unchecked exceptions`)**: Включают в себя ошибки (`errors`) и исключения времени выполнения (`runtime exceptions`). Ошибки, как правило, описывают внутренние проблемы в работе виртуальной машины Java или недостаток ресурсов, и от них восстановление обычно не предполагается (например, `OutOfMemoryError`). Исключения времени выполнения указывают на ошибки в логике программы, которые могут быть предотвращены перед выполнением (например, `NullPointerException`).

### Иерархия исключений

Все классы исключений в Java наследуются от класса `Throwable`. От него напрямую наследуются два класса: `Error` (описывает внутренние системные ошибки) и `Exception` (исключения, которые может обрабатывать приложение). `RuntimeException` является подклассом `Exception` и служит базовым классом для всех непроверяемых исключений времени выполнения.

### Обработка исключений

Обработка исключений в Java осуществляется с помощью блоков `try`, `catch` и `finally`:

- **`try`**: Код, в котором может возникнуть исключение, помещается внутри блока `try`.

- **`catch`**: После блока `try` следует один или несколько блоков `catch`, перехватывающих и обрабатывающих исключения. Каждый блок `catch` обрабатывает определённый тип исключения.

- **`finally`**: Блок `finally` содержит код, который будет выполнен после блока `try/catch`, независимо от того, возникло ли исключение. Это идеальное место для освобождения ресурсов, таких как закрытие файлов или сетевых соединений.

### Пример

```java
try {
    // Код, который может вызвать исключение
} catch (SpecificExceptionType e) {
    // Обработка конкретного типа исключения
} catch (AnotherExceptionType e) {
    // Обработка другого типа исключения
} finally {
    // Код, выполняемый всегда после блоков try/catch
}
```

Использование исключений позволяет разрабатывать надёжные и устойчивые к ошибкам приложения, правильно обрабатывая исключительные ситуации.

Давайте разберём более подробно работу с исключениями в Java, включая различные способы их обработки и создания собственных типов исключений, снабдив это более разнообразными примерами.

### 1. Обработка исключений с использованием `try-catch`

Java использует конструкцию `try-catch` для обработки исключений. В блоке `try` размещается код, который может вызвать исключение, а в блоке `catch` — код для его обработки.

#### Пример: деление на ноль с обработкой исключения

```java
public class DivisionExample {
    public static void main(String[] args) {
        try {
            int a = 5;
            int b = 0; // Делитель равен нулю
            int result = a / b;
            System.out.println("Результат: " + result);
        } catch (ArithmeticException e) {
            System.out.println("Ошибка арифметики: Деление на ноль.");
        }
    }
}
```

### 2. Множественный `catch`

Вы можете перехватывать несколько типов исключений, используя несколько блоков `catch`. Java проверяет исключения в том порядке, в котором они указаны, поэтому убедитесь, что более специфичные исключения перехватываются перед более общими.

#### Пример: Обработка разных типов исключений

```java
public class MultipleCatchExample {
    public static void main(String[] args) {
        try {
            String input = args[0];
            System.out.println("Первый символ: " + input.charAt(0));
            System.out.println("Число, полученное из строки: " + Integer.parseInt(input));
        } catch (ArrayIndexOutOfBoundsException e) {
            System.out.println("Аргумент не был предоставлен.");
        } catch (NumberFormatException e) {
            System.out.println("Введённая строка не является числом.");
        } catch (Exception e) {
            System.out.println("Произошла неизвестная ошибка.");
        }
    }
}
```

### 3. Блок `finally`

Блок `finally` исполняется после выполнения блоков `try` и `catch`, независимо от того, было ли исключение перехвачено или нет. Это идеальное место для кода, который должен выполняться в любом случае, например, для закрытия файлов или освобождения ресурсов.

#### Пример с `finally`

```java
public class FinallyExample {
    public static void main(String[] args) {
        try {
            int[] numbers = {1, 2, 3};
            System.out.println(numbers[5]);
        } catch (ArrayIndexOutOfBoundsException e) {
            System.out.println("Индекс вне диапазона массива.");
        } finally {
            System.out.println("Этот код выполняется всегда.");
        }
    }
}
```


